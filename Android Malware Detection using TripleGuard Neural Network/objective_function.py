from load_save import *
from classifer import *

def obj_fun(soln):
    X_train = load('X_train')
    X_test = load('X_test')
    y_train = load('y_train')
    y_test = load('y_test')

    # Feature selection
    x = np.round(soln)
    selected_indices = np.where(x == 1)[0]
    if len(selected_indices)<70:
        fit = 100
    else:
        selected_indices = selected_indices[selected_indices < X_train.shape[1]]
        x_train = X_train[:, selected_indices]
        x_test = X_test[:, selected_indices]
        pred, met = EnsembleNet(x_train, y_train, x_test, y_test)
        fit = 1 / met[0]

    return fit